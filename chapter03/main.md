# 03. Using All the Information: Estimating Parameters and Bayes' Theorem

前章では、評価された確率分布の統計的性質と、その分布から取り出した標本と正規分布との関係を説明しました。しかし、この章では、サンプリング分布の検討において基礎となる分布のパラメータを検討する際に、基礎となる分布のパラメータが分かっていることを前提にしていました。しかし、実際には多くの場合、これらのことがわかっていないということがよくあります。コイントスのような単純なものでさえ、結果の「真の」分布は次のようなものです。コインが非常にわずかに一方向に偏っています。サイコロは、その表面や組成に小さな欠陥がありそれがある面に出やすいようになっています。しかし、このような影響は通常小さいので、「理論上」50対50になるコインを使用することは、今回の目的では合理的な近似値であると言えます。同様に、ポーカーの分析では、デッキは公平であり、各カードは観察されるまではランダムであると仮定します。

コインやサイコロのように合理的に近似できる分布は、現実世界ほど複雑ではありません。しかし、それ以外の分布では、より難しい問題が生じます。ポーカーの結果を分析する場合、前章で説明した分布、すなわちハンドごとの勝ち負けの金額に興味を持つことがよくあります。カジノでプレイする場合、すべてのハンドの結果を記録することは非常に困難であり、時間もかかります。オンラインでは、ダウンロード可能なハンドヒストリーやソフトウェアツールを使って、このプロセスを自動化することができるので、多少は簡単です。しかし、これだけのデータがあっても、それは単なる標本に過ぎません。ポーカーハンドの場合、よほど大量のデータがない限り、基礎となる分布の確率が観測データに反映されることはありません。

このことは、前章の題材を使うことである程度回避することができます。ハンドの分布の平均と分散を求めることができたとします。そうすると、標本分布を求め、異なる数のハンドをプレイした結果の集計を予測することができます。将来の特定の標本の実際の結果を予測することはできませんが、起こるであろう結果の分布を予測することはできます。

さて、問題は標本の平均と分散から母集団の平均と分散を推論しようとすることです。このプロセスに対して、2つのアプローチを検討します。一つは古典的な統計学のアプローチで、もう一つは本章の主要テーマであるベイズの定理を利用したアプローチです。最初のアプローチは、標本以外に尤度に関する情報を持っていないことを前提にしています。第二のアプローチは、特定の標本以外に存在する勝率の分布を仮定し、それを用いて母集団の平均と分散の推定値を精緻化するものです。これは母集団分布の平均と分散の推定に使用することができます。

## パラメータを推定する: 古典統計学

リミットポーカーで合計16,900ハンドをプレイしたプレイヤーがいるとします。プレイしたレートの違いを考慮し、結果をビッグブラインド(BB)に正規化すると、勝率 $x = 1.15$ (BB/100 hands)、標準偏差 $s = 2.1$ (BB/hand)を達成したとします。ここで、母集団のパラメータである $\mu$ と $\sigma$ の代わりに、標本のパラメータである $x$ と $s$ を用いています。今後も同じような組み合わせのゲームで同じようなプレイヤーのラインナップでプレイすると仮定すると、プレイしたゲームでの「真の」勝率 $\mu$ について何が言えるでしょうか？この節では、可能性のあるさまざまな勝率について、他の情報は持っていないと仮定します。 $-1$ (BB/hand)から $+1$ (BB/hand)までのすべての勝率は、同じ確率であると見なすことにします。

まず重要なのは、私たちが扱っているのは標本だけであるということです。その結果、勝率の値には不確かさが存在します。しかし、中心極限定理により、16,900ハンドのリミットポーカーの標本分布は、ほぼ正規分布になることが分かっています。特に、標本数が比較的大きいので、観測された標準偏差 $s = 2.1$ (BB/hand)は母集団の標準偏差の妥当な推定値です。このことからこれらの事実を利用して、母平均の[最尤推定量](https://ai-trend.jp/basic-study/estimator/maximum-likelihood-estimation/)を求めることができます。

すべてのありうる勝率を考えてみましょう。それぞれの勝率に対応する標本分布があります。平均を $\mu$ 、標準偏差を $\sigma_N$ とする正規曲線です。これらの正規曲線のピークは $x = \mu$ であり、他の点はすべてそれより低い値です。ここで、母平均が実際にある特定の $\mu$ であると仮定します。 $x = \bar{x}$ における曲線の高さは、観察された標本平均が標本の結果である確率と関連づけられます。 $\mu$ のすべてのありうる値について、この値を求めることができます。これらの正規曲線は同じ標準偏差 $\sigma_N$ を持つので、それらはすべて同じになりますが、図3.1のようにX軸に沿ってシフトしています。

![shifted-normal-distribution](/resources/img/chapter03/main/03-01.png)

曲線のピークが最高点であり、観測値は $\mu = \bar{x}$ のときのピークなので、 $\bar{x} - 1.15$ (BB/100hands)が分布の平均の最尤推定量であることを意味します。これは直感的に理解できるかもしれませんが、この問題に対する別のアプローチを考えると、追加情報を取り込めば、最尤推定量は必ずしも標本平均と一致する必要はないことがわかります。

標本が与えられたときに最も可能性の高い単一の勝率が標本平均であることを知っていることは有用なデータですが、不確実性についてはあまり役に立ちません。結局のところ、仮想的なプレイヤーは、運が良かったかもしれないし、悪かっただけかもしれません。標本の標準偏差を計算し、可能な勝率についてwhat-if分析を行うことができます。

16,900のハンドからなる標本 $N$ があるとします。平均、つまり勝率は $1.15$ (BB/100hands)、標準偏差は $2.1$ (BB/hand)です。

次に、(2.4)を用いて、

$\sigma_N = \sigma\sqrt{N}$  
$\sigma_{16,900} = 2.1$ (BB/hand) $\cdot$ $\sqrt{16,900}$ (hands)  
$\sigma_{16,900} = 273$ (BB)なので  
$\sigma_N$ (/100hands) $= \dfrac{273}{169} \simeq 1.61$

この大きさの標本の標準偏差は、勝率そのものよりも大きいです。仮に、基礎となる分布のパラメータが観測されたものと同じであることが分かっていたとします。16,900ハンドの標本をもう一回採取すると、32%の確率で(平均値を中心とした標準偏差の2倍の幅に入るデータの割合は68%のため)、16,900ハンドのサンプルの観測結果は $-0.46$ (BB/100hands)より低くなるか、 $2.76$ (BB/100hands)より高くなります。

これは少し困ったことです。仮にそうであったとしても、別の標本はそのかなり広い範囲から32%の確率で外れてしまうのに、標本が真の母平均を表しているという考えに確信が持てるのでしょうか？また、真の母平均が例えば $0$ であったとしたらどうでしょうか。そうすると、 $1.15$ は $1\sigma$ 区間にうまく収まるでしょう。実際、このサンプルでは、勝率 $0$ と勝率 $1.15$ (BB/hands)の違いを明確に区別することはできません。

この不確実性を把握するためにできることは、**信頼区間**を設けることです。信頼区間を作るには、まず許容範囲を決めなければなりません。なぜなら、私たちが扱うのは 統計的プロセスを扱っているので、母平均がある特定の値を持つ確率が $0$ であるとは単純に言えません。私たちは非常に幸運だったかもしれないし、非常に不運だったかもしれないのです。しかし、有意水準と呼ばれるものを使うことができます。これは、誤差の許容範囲を表す確率の値です。そして、信頼区間は、「観察された結果が発生する確率が、選択した有意水準より小さくなるような母平均値は何か？」という問いに対する答えです。

プレイヤーに対して、有意水準95％を選んだとします。そうするとプレイヤーの信頼水準を求めることができます。母平均を $\mu$ とすると，この母集団から採取したこのサイズの標本は，95%の確率で $\mu - 2\sigma$ と $\mu + 2\sigma$ の間にあることになります。ということは、観測される $\mu$ の値をすべて求めればよいことになります。したがって，観測値＝ $1.15$ がこの2つの境界の間にあるような $\mu$ の値をすべて求めればよいことになります。

先ほど計算したように、16,900ハンドの標本の標準偏差は、 $1.61$ (BB/100hands)となります。

$\sigma_N = \sigma\sqrt{N}$  
$\sigma_{16,900} = 2.1$ (BB/hand)( $\sqrt{16,900}$ hands)  
$\sigma_{16,900} = 273$ (BB)なので  
$\sigma_N$ (/100hands) $= \dfrac{273}{169} \simeq 1.61$

つまり、母平均が次の2式を満たす限り、信頼区間内に入ることになります。

$\mu - 2\sigma < 1.15$ and $\mu + 2\sigma > 1.15$

$\mu - 2\sigma < 1.15$  
$\mu - 2 \cdot 1.61 < 1.15$  
$\mu < 4.37$  

$\mu + 2\sigma > 1.15$  
$\mu + 2 \cdot 1.61 > 1.15$  
$\mu > -2.07$

つまり、このプレイヤーの勝率の95%信頼区間は(集めた16,900ハンドの標本に基づいて)\[ $-2.07$ BB/100hands, $4.37$ BB/100hands\]ということになります。

これは、**真の割合がこの区間上に95％の確率で存在するという意味ではありません**。これは信頼区間の定義に対するよくある誤解です。信頼区間とは、もしそれが真の割合であれば、観測された割合は95％の確率で発生する値の範囲内にあるすべての値のことです。古典的な統計学では、パラメータ値の確率推定は行いません。実際、古典統計学的な見解では、真の勝率は区間内にあるかないかのどちらかであり、それはランダムな事象の結果ではないためです。どんなにサンプリングしても、パラメータが何であるかを確かめることはできません。その代わりに、パラメータが特定の値であった場合に、特定の結果を観察したであろう可能性、あるいは可能性の低さについて主張することができるだけです。最尤推定値と信頼区間は、標本から得られる情報を評価するのに便利なツールです。この場合、 $1.15$ (BB/100hands)の割合が合理的に見えても、この割合が本当のものに近いと結論づけるのは少し早計です。信頼区間は、母集団の割合がどの程度の幅を持つ可能性があるかを示すものです。しかし、強いて言えば、全体の勝率の最良の推定値は最尤推定値であり、この場合は標本平均値である $1.15$ (BB/100hands)です。

ここまでのところでは、異なる勝率の可能性についての情報はないと仮定してきました。つまり、あるプレイヤーがどのような勝率を持つかについてのデータの唯一の情報源は、実験的証拠だけであると仮定してきたのです。しかし、実際には、測定する前からある勝率は他の勝率よりも可能性が高いのです。例えば、カジノで5,000ハンドのポーカーをプレイし、その中で500BBを獲得したとします。これは、100ハンドあたり10BBの割合です。この場合、前節の最尤推定は、あなたの勝率はまさに100ハンドあたり10BBであったということになります。

しかし、私たちは他の情報を持っています。統計的に有意な数のハンドをプレイしたプレイヤーの中で、最も高い勝率は3-4(BB/100hands)付近であることを示す、前例やハンド履歴データベースなどから抽出したかなり多くの証拠があるのです。これより高い勝率を持つ少数の異常値でさえも、 $10$ (BB/100hands)には達しません。これは計測を始める前から持っている情報なので、先験的情報と呼びます。

実際、測定した特定のプレイヤーが全ポーカープレイヤーの中からランダムに選ばれたと考えるだけで、その勝率に関連する確率分布が存在します。もちろん、この分布の正確な形はわかりません。なぜなら、ポーカープレイヤー全体の観測証拠がないからです。しかし、勝率の先験的分布について正しい仮定を立てることができれば、2つの証拠を組み合わせることによって、観測された証拠に基づくパラメータのより良い推定を行うことができます。

## ベイズの定理

第2章で、確率の基本原理を述べました(式1.5)。

$p(A \cap B) = p(A)p(B|A)$

この式では、Aの確率と、Aが発生した時のBの条件付き確率から、AとBの同時確率を計算することができます。しかし、ポーカーでは、Aがすでに発生しているときのBの条件付き確率を計算することに最も関心があります。たとえば、自分のハンド(A)を知っているもとで、その情報が相手のハンド(B)にどう影響するかを知りたいのです。そこで求められるのが、Aを仮定したときのBの条件付き確率です。

そこで、式1.5を整理して、条件付確率の式を作ってみましょう。

これが**ベイズの定理**と呼ばれる式です。

$p(B|A) = \dfrac{P(A \cap B)}{p(A)}$ **(3.1)**

第1章で $\bar{B}$ を $B$ の補集合として定義しました。つまり、

$p(\bar{B}) = 1 - p(B)$  
$p(B) + p(\bar{B}) = 1$

以下はすでに定義しています。

$p(A \cap B) = p(A)p(B|A)$

$B$ と $\bar{B}$ の和が $1$ になることが分かっているので、 $p(A)$ は $B$ が発生したときの $A$ の条件付き確率と、 $\bar{B}$ が発生したときの $A$ の条件付き確率を足したもので表すことができます。

$P(A) = P(A|B)P(B) + P(A|\bar{B})P(\bar{B})$

そこで、(3.1)を次のように書き換えることができます。

$p(B|A) = \dfrac{p(A|B)p(B)}{p(A|B)p(B) + p(A|\bar{B})p(\bar{B})}$ **(3.2)**

ポーカーでは、ベイズの定理によって、観察した新しい情報に基づいて、確率の判断を改良することができます。実際、強いプレイヤーは新しい情報が現れるとベイズの定理を常に使って、確率の評価を絶えず洗練させています。ベイズの推論のプロセスは、第二部で見るように、ハンドリーディングとアグレッシブプレイの核心となるものです。

ベイズの定理の典型的な例として、医者の例があります。ある特定の疾患について診察を行ったとします。もし、その疾患を持つ人が診察を受けた場合、80%の確率でその疾患を適切に特定します。もし、その疾患を持たない人が診察を受けた場合、10％の確率でその疾患を持つと誤判定(偽陽性)します。人口の5％（平均）がこの病気を持っているとします。

ここで、母集団の中から無作為に選ばれた人が診察を受け、陽性反応が出たとします。この人がこの病気である確率はどのくらいでしょうか？(さらなる診察や診断がない場合)

もし、あなたが「80％くらいか、それ以下」と答えたとしたら、それは間違いですが、これはよくある間違いです。このような質問に対する医師の反応を調査したところ、ベイズの概念を恐ろしく理解していないことがわかりました。

ベイズの定理を使って、この問題の答えを次のように求めることができます。  
$A =$ 「診察の結果、陽性であった」  
$B =$ 「患者が実際に陽性である」

そこで、確率 $p(B|A)$ を求めると、次のようになります。

$p(B|A) = 0.8$  
(患者に疾患がある場合、スクリーニングは80%の確率で陽性となる)

$p(\bar{B}|A)= 0.1$  
（患者に疾患がない場合、スクリーニングの結果は10％の確率で陽性となる）

$p(B) = 0.05$ (全体の5％の人がその状態である)  
$p(\bar{B}) = 0.95$ (全体の95%の人はその病気ではない)

そして、(3.2)を用いると、次のようになります。

$p(B|A) = \dfrac{p(A|B)p(B)}{p(A|B)p(B) + p(A|\bar{B})p(\bar{B})}$

$p(B|A) = \dfrac{(0.8)(0.05)}{(0.8)(0.05)+(0.1)(0.95)} = 0.2963$

ご覧の通り、診察結果が陽性であった患者が実際にその疾患を持っている確率は、その疾患を持つ人においてその疾患を特定する上で、検査が持つ80%の「精度」よりもずっと低いのです。この検査では、病態の存在を確認するために追加の検査を行う必要があります。

しかし、ただ方程式に当てはめるのではなく、ここで何が起こっているのか、10万人の人口を考え、その全員がこのスクリーニング・プロセスを使って検査を受けたと仮定して議論してみましょう。

この10万人のうち、
5,000人が実際に発症している(人口の5%)  
95,000人は、実際に発症していない(人口の95%)  

5,000人のうち、4,000人が陽性となる。  
4,000人が陽性と判定される(陽性者の80%)  
1,000人が陰性と判定される(20%の偽陰性)  

95,000人のうち、9,500人が陽性と判定される。
9,500人が陽性と判定される(10%の偽陽性)
85,500人は陰性と判定される(90%の人が陰性)

では、検査で陽性となった人は、どの程度の確率でこの病気にかかっているのでしょうか？10万人の検査対象者のうち、合計13,500人が陽性と判定されました。そのうち4,000人だけが、実際に病気を持っていることになります。

$p(B|A) = 4,000/13,500$  
$p(B|A) \simeq 29.6\%$

さらに、テストの精度を上げること、つまり、疾患を持つ人の疾患を識別する精度を上げるか、そうでない人の疾患の偽陽性識別を少なくすることで、テスト陽性者が疾患を持つという条件付き確率を上げることができることがわかります。しかし、これは実際にその病気に罹患している確率を高めるものではありません。むしろ、間違って陽性と判定され、自分が病気であると間違って信じるというストレスを受けなければならない人の数を減らすことができるのです。

仮に、誤判定率はそのままで、その条件に当てはまる人を必ず特定できるように、検査の有効性を高めたとします(偽陰性の発生確率を0にする)。そのとき、ベイズの定理を用いて、

$p(B|A) = \dfrac{p(A|B)p(B)}{p(A|B)p(B) + p(A|\bar{B})p(\bar{B})}$

$p(B|A) = \dfrac{(1)(0.05)}{(1)(0.05)+(0.1)(0.95)} = 0.345$

同様に、識別率80％を一定にして、誤検出の割合を10％から6％に落とすと、次のようになります。

$p(B|A) = \dfrac{(0.8)(0.05)}{(0.8)(0.05)+(0.06)(0.95)} = 0.412$

ベイズの定理を応用する上で重要なのは、事前確率の存在と新しい情報を得ることです。上記の例では、患者がこの病気であるという事前確率を5％としてスタートしました。診察の結果、陽性であったことが新たな情報となり、患者の確率を修正することができました(この場合は、上方修正)。このプロセスはベイズ推論と呼ばれ、ポーカーで結果を出すためには非常に重要です。ベイズ推論の使い方は無数にあり、実際、多くのプレイヤーが無意識にベイズ推論を使っています。トーナメントで、あるプレイヤーが序盤のテーブルで負けてしまった場合を考えてみましょう。そのプレイヤーは新しいテーブルに移動しましたが、そこでは右隣のプレイヤーがすでにスタート時の7倍のスタックを集めており、一方でトーナメントの他のほとんどのプレイヤーはまだスタート時のスタックに近い状態でした。ほとんどのプレイヤーは、2つのシナリオがあり得ると考えるでしょう。巨大なスタックを持つプレイヤーは、非常にルーズでアグレッシブなプレイヤーであるか、単に非常に幸運だった普通のプレイヤーであるかのどちらかです。運のいいプレイヤーよりも、ルーズでアグレッシブなプレイヤーである可能性が高いと考えるのは、このテーブルのプレイヤーがこの概念を知っているかどうかにかかわらず、ベイズの定理の直接的な結論です。

この効果をベイズの定理の形式的なバージョンで定量化することで、確かな情報がなくても、より強いプレーをすることができるようになるのです。次のようなよくある状況を考えてみましょう。

新しいプレイヤーがゲームに着席します。そのプレイヤーの民族性、性別、態度、服装、身なりなど、あらゆる観察情報から、そのプレイヤーはCOから80%のハンドレンジでレイズをする「マニアック」である可能性が10%、10%のハンドレンジでレイズをする「タイトプレイヤー」である可能性が90%だと結論づけたとします。そのプレイヤーはカットオフで最初のハンドでレイズしました(ポスティングはないと仮定します)。さて、そのプレイヤーがマニアックである確率はどれくらいでしょうか？

この問題はベイズの定理で解くことができますが、この問題を続ける前に、ぜひこの確率を推定してほしいです。直感を試すことは、正確な予測能力を磨くのに最適な方法の一つであり、ポーカーだけでなく人生においても貴重なスキルです。

$A =$ 「相手はCOからプレイした最初のハンドでレイズする」  
$B =$ 「相手はマニアックである」

$p(A|B) = 0.8$ (マニアックである場合，80%の確率でレイズする)  
$p(A|\bar{B}) = 0.1$ (マニアックでない場合、10%の確率でレイズする)  
$p(B) = 0.1$ (10%の確率でマニアックである)  
$p(\bar{B})= 0.9$ (90%の確率でマニアックではない)

再びベイズの定理を適用します。

$p(B|A) = \dfrac{p(A|B)p(B)}{p(A|B)p(B) + p(A|\bar{B})p(\bar{B})}$

$p(B|A) = \dfrac{(0.8)(0.1)}{(0.8)(0.1)+(0.1)(0.9)} = 0.471$

つまり、このプレイヤーが最初のハンドでレイズするのを観察するだけで、マニアックである確率をわずか10%から47%に即座に調整することができるのです。もしこのプレイヤーが最初の2回のハンドをレイズした場合(HJ、BTNも同じ推論と仮定)、この確率は87%近くにまで上昇します。もちろん、これらの確率は、最初に仮定したことの正確さに左右されます。現実には、2種類のプレイヤーだけが存在するわけではないですし、私たちの確率の推定は、おそらく彼がどのタイプのプレイヤーであるかについてそれほど正確ではないでしょう。

プレイヤーの一つの傾向として、いくつかのハンドを観察するなどして、もう少し情報を得るまで、そのプレイヤーの特徴を把握したり調整したりするのを遅らせようとすることがあります。しかし、このような考え方は、私たちの見解では、過度に受動的です。EVを最大化するということは、自由に使えるすべての情報を活用することであり、必ずしもその情報が信頼できるかどうか確認するのを待ってから活用しようとすることではないのです。このようなプレイヤーが犯している誤りは、彼らが得た情報の力を認識していないことです。多くのプレーヤーは、たとえ上手くないプレーヤーであっても、この調整、あるいは同様の調整を直感的に行っていることが多いことは注目に値します。しかし、注意してほしいのは、この調整は、ゲームの中でプレイヤーの大幅な調整を誘発しようと、ゲームに座って普段のスタイルとは全く異なるプレイをするプレイヤーに悪用される可能性があります。

強いプレイヤーは、新しい情報が現れるとベイズの定理を常に使って、自分の確率評価を絶えず洗練させていきます。ベイズ推論のプロセスは、第II部で見るように、ハンドのリーディングとエクスプロイトプレイの核心になるものです。しかし、テーブルを離れても、ベイズの定理は、データについてより多くの情報に基づいた結論を下すことを可能にします。この例を見るために、勝率の話題に戻ってみましょう。

## パラメータを推定する: ベイズ統計学

この章の前半で、リミットポーカーで合計16,900ハンドをプレイしたプレイヤーについて、次のような統計量を観測しました。  
勝率: $\bar{x} = 1.15$ (BB/100hands)  
標準偏差: $s = 2.1$ (BB/hand)

これらの観察結果に基づいて、このプレイヤーの「真の」勝率についてどのような記述が可能であるかに関心を持ちました。古典的統計学の方法を用いて、勝率の最尤推定値は $1.15$(BB/100hands)であり、95%信頼区間は\[$-2.07$ (BB/100hands), $4.37$ (BB/100hands)\]であることがわかりました。これらの記述は、このプレイヤーの勝率の分布についての追加情報がないという仮定に依存しています。

しかし、勝率の分布を推測し、より正確な推定を行うために、勝率の分布とこのプレイヤーの結果にベイズの定理を適用しようとしたとします。そのためには、まず、このプレイヤーの勝率分布全体の仮説を立てる必要があります。このプレイヤーは通常のポーカープレイヤーの中からランダムに選ばれたと仮定しましょう。この分布(**事前確率分布**)はどのような形をしているのでしょうか。

この分布がどのようなものか、一見するとかなり不明です。何しろ、私たちは幅広い母集団の成績や記録を入手することができまないためです。しかし、単純化して推定することで、勝率の分布が十分に真実に近くなり、それを推定に取り入れることで得られる可能性があります。このプレイヤーが\$10-\$20から\$30-\$60のような低いミッドリミットのゲームをプレイしていると仮定すると、ゲームから支払われるレーキの総額は、1ハンドあたり\$3-\$4程度、あるいは $0.1$ BB/handと見積もることができます。これを全プレイヤーにほぼ等しく分配すると、全員の勝率に対する正味のレーキは約 $0.01$ (BB/hand)、つまり $1$ (BB/100hands)となります。

全プレイヤーの勝率分布の平均値は、この値と等しく、これがゲームから流出するお金の正味の流れです。仮に勝率がほぼ正規分布に従うとし、（勝率の）標準偏差を約 $0.015$ (BB/hand)と見積もってみましょう。そうすると、68%のプレイヤーが $-2.5$ (BB/100hands)から $+0.5$ (BB/100hands)の間の勝率で、95%のプレイヤーが $-4$ (BB/100hands)から $+2$ (BB/100hands)の間の勝率であることになります。これは、あなたの直感と一致するかもしれません。そうでない場合、これらの数字は、基本的なプロセスを変えることなく、異なる仮定を反映するために微調整することができます。

計算を簡単にするために、連続的な正規分布を使う代わりに、先ほどの仮定をほぼ反映した離散的な分布を作成します。ここでは、すべてのポーカープレイヤーの基本的な分布が、次のようなものであると仮定します。

|Win rate|% of players with this win rate|
|:--:|:--:|
|-5 BB/100hands|0.25%|
|-4 BB/100hands|2%|
|-3 BB/100hands|8%|
|-2 BB/100hands|20%|
|-1 BB/100hands|39.5%|
|0 BB/100hands|20%|
|+1 BB/100hands|8%|
|+2 BB/100hands|2%|
|+3 BB/100hands|0.25%|

勝率の**事前確率分布**が得られたので，この問題にベイズの定理を適用することができます。各勝率について、計算します。

A = 「 $1.15$ という勝率が観測される確率」  
B = 「この特定の勝率が真の勝率である確率」(a priori)

ある勝率が観測される確率を直接求めることはできません(正規分布が連続分布であるため)。その代わりに、 $1.14$ から $1.16$ の間の勝率が観測される確率を、この値の代理として代用することにします。このサイズのサンプルの標準偏差が $1.61$ BBであることを思い出してください。 $p(A|\bar{B})$ は、現在の行を除いた $p(A|B)$ の加重平均を計算するだけです。確率表から、

|Win rate| $p(B)$ | $p(A\|B)$ | $p(A\|\bar{B})$ | $p(\bar{B})$ |
|:--:|:--:|:--:|:--:|:--:|
|-5 BB/100hands|0.25%|0.000004|0.00222555|99.75%|
|-4 BB/100hands|2%|0.000031|0.00226468|98%|
|-3 BB/100hands|8%|0.000182|0.00239720|92%|
|-2 BB/100hands|20%|0.000738|0.00259053|80%|
|-1 BB/100hands|39.5%|0.002037|0.00233943|60.5%|
|0 BB/100hands|20%|0.003834|0.00181659|80%|
|+1 BB/100hands|8%|0.004918|0.00198539|92%|
|+2 BB/100hands|2%|0.004301|0.00217753|98%|
|+3 BB/100hands|0.25%|0.002564|0.00221914|99.75%|

各行に対してベイズの定理を適用して、

$p(B|A) = \dfrac{p(A|B)p(B)}{p(A|B)p(B) + p(A|\bar{B})p(\bar{B})}$

|Win rate|$p(B\|A)$|
|:--:|:--:|
|-5 BB/100hands|0.00%|
|-4 BB/100hands|0.03%|
|-3 BB/100hands|0.66%|
|-2 BB/100hands|6.65%|
|-1 BB/100hands|36.25%|
|0 BB/100hands|34.54%|
|+1 BB/100hands|17.72%|
|+2 BB/100hands|3.87%|
|+3 BB/100hands|0.29%|
|Total|100%|

古典的なアプローチから考えた時、最尤推定量を計算することができました。同じように、これらの仮定があれば、 $-1$ (BB/100hands)を最尤推定量として特定することができます。もちろん、これらの仮定は本当の真実ではありません.プレイヤーにとって可能な勝率は連続に近いものです。それでも、もし連続分布を使って、そこから生じるより複雑な計算をすれば、この分布と似たような分布が見つかるはずです。このアプローチの重要な意味は、勝てるプレイヤーは相対的に少ないので、このプレイヤーは、勝率がプラスであるのと同じくらい、運が良かった負け組プレイヤーである可能性が高いということです。

もし，観察された勝率がもっと高いプレイヤー、おそらく $5$ (BB/100hands)のプレイヤーを考えたら，このことはもっとはっきりわかるでしょう。古典的なアプローチでは、やはり最尤推定量を $5$ (BB/100hands)とします。なぜなら、古典的な方法では、すべての勝率が等しいと考えるからです(古典的な方法では、勝率の分布に関する追加情報がないため)。しかし、上記の分析を、観測された勝率 $5$ BBで再計算すると、次のようになります。

|Win rate|$p(A\|B)$|
|:--:|:--:|
|-5 BB/100hands|0.00%|
|-4 BB/100hands|0.00%|
|-3 BB/100hands|0.00%|
|-2 BB/100hands|0.16%|
|-1 BB/100hands|3.79%|
|0 BB/100hands|15.78%|
|+1 BB/100hands|35.40%|
|+2 BB/100hands|33.84%|
|+3 BB/100hands|11.03%|
|Total|100%|

この場合、このプレイヤーは勝ち組であることが強く考えられ、しかも相当なものであることがわかります。しかし、 $5$ (BB/100hands)の勝率は母集団に存在しないので、ベイズの定理により彼の勝率は全プレイヤーの上位10%の可能性が高いように適切に調整されます。

より多くのデータを集めれば、ベイズの推定値は当然、観測された勝率に収束するはずです。ある割合で勝つ能力を一貫して示してきたプレイヤーほど、それが彼の真の割合である可能性が高くなるのです。そして、10万ハンドの標本で上記を再計算すると、次のようになります。

|Win rate|$p(A\|B)$|
|:--:|:--:|
|-5 BB/100hands|0.00%|
|-4 BB/100hands|0.00%|
|-3 BB/100hands|0.00%|
|-2 BB/100hands|0.00%|
|-1 BB/100hands|1.57%|
|0 BB/100hands|33.42%|
|+1 BB/100hands|58.37%|
|+2 BB/100hands|6.60%|
|+3 BB/100hands|0.04%|
|Total|100%|

この標本サイズによって、基礎となる分布では10％のプレイヤーしか少なくとも $1$ (BB/100hands)を獲得していないにもかかわらず、観測値が現実と一致していることをより確信することができます。

古典的統計学者(頻度論者と呼ばれることもある)とベイズ統計学者との間には、多少の乖離があることを指摘しておく必要があります。この意見の相違は、母集団のパラメータを確率分布として考えるべきだというベイズ的な考え方に(おおよそ)集約されます。ベイズ派は事前分布を推定し、サンプルを観察し、新しい証拠に照らして事前分布を調整します。頻度論者はこの考え方を否定し、母集団のパラメータを、たとえその値を知ることができなくても、固定的で不変の値として特徴づけることを好みます。我々は、ポーカー分析における有用性から、ベイズ的な視点を強く志向しています。

ここで用いた方法は、本格的なベイズ手法でもなく、単にベイズ分析の手法を簡略化して、その考え方を身近なものにすることを意図したものです。この点、またベイズ的手法の実践者と古典的統計学者の間の溝については、上級統計学のテキスト、特に点推定とベイズ的手法を徹底的に扱ったテキストを参照されることをお勧めします。

この分析から浮かび上がってくる1つのトピックは、**平均への回帰**という考え方です。例えば、小さいサイズの標本で勝率を観察したとします。この考え方は、平均値より高い勝率を観測すると、将来その観測を繰り返したときに低くなる傾向があり、平均値より低い勝率を観測すると、将来はより良いパフォーマンスを示す傾向があるというものです。これは、過去の突出した試行が将来の突出した試行(逆方向)によって相殺されるというような、何らかの統計的な「平準化」によるものではありません。ここで働く原理は、母集団全体の平均を上回った場合、自分の期待値も上回った可能性が高く、一方、平均を下回った場合、自分の期待値も下回った可能性が高いというものです。その結果、あなたは全プレイヤーの平均に向かって少し後退する傾向があります（非常にわずかな場合もあります）。つまり、私たちが作ることのできる最高の予測には、全体の平均と観測結果が少し混ざっているのです。16,900ハンドの後、彼の調整済み勝率予測はまだ非常に大きく母集団の分布に影響されており、彼の勝率は母集団の平均である-1BB/100に向かって下方修正されています。
